import numpy as np
import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.ensemble import RandomForestClassifier
import joblib
dataset1 = pd.read_csv("/home/kali/Project/MALWARE_ANALYSIS/API_Functions.csv")
dataset2 = pd.read_csv("/home/kali/Project/MALWARE_ANALYSIS/DLLs_Imported.csv")
dataset3 = pd.read_csv("/home/kali/Project/MALWARE_ANALYSIS/PE_Header.csv")
dataset4 = pd.read_csv("/home/kali/Project/MALWARE_ANALYSIS/PE_Section.csv")

X1 = dataset1.iloc[:, 2:]
y1 = dataset1.iloc[:, 1]
X1_train, X1_test, y1_train, y1_test = train_test_split(X1, y1, test_size=0.2, random_state=42)

X2 = dataset2.iloc[:, :-1]
y2 = dataset2.iloc[:, -1]
X2_train, X2_test, y2_train, y2_test = train_test_split(X2, y2, test_size=0.2, random_state=42)

X3 = dataset3.iloc[:, :-1]
y3 = dataset3.iloc[:, -1]
X3_train, X3_test, y3_train, y3_test = train_test_split(X3, y3, test_size=0.2, random_state=42)

X4 = dataset4.iloc[:, :-1]
y4 = dataset4.iloc[:, -1]
X4_train, X4_test, y4_train, y4_test = train_test_split(X4, y4, test_size=0.2, random_state=42)

model1 = RandomForestClassifier(n_estimators=100, random_state=42)
model1.fit(X1_train, y1_train)
file_path="/home/kali/Project/MALWARE_ANALYSIS/API_MODEL.joblib"
with open(file_path,'wb') as file:
    joblib.dump(model1,file)
model2 = RandomForestClassifier(n_estimators=100, random_state=42)
model2.fit(X2_train, y2_train)
model3 = RandomForestClassifier(n_estimators=100, random_state=42)
model3.fit(X3_train, y3_train)
model4 = RandomForestClassifier(n_estimators=100, random_state=42)
model4.fit(X4_train, y4_train)
file_path="/home/kali/Project/MALWARE_ANALYSIS/DDL_MODEL.joblib"
with open(file_path,'wb') as file:
    joblib.dump(model2,file)
file_path="/home/kali/Project/MALWARE_ANALYSIS/PEH_MODEL.joblib"
with open(file_path,'wb') as file:
    joblib.dump(model3,file)
file_path="/home/kali/Project/MALWARE_ANALYSIS/PES_MODEL.joblib"
with open(file_path,'wb') as file:
    joblib.dump(model4,file)

